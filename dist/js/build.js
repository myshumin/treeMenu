!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";var n=r(1);(new n.Tree).init()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Tree=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2),s=r(3),o=r(4),c=r(5),u=r(6),l=r(7),f=r(8);t.Tree=function(){function e(){n(this,e),this.FORM=(0,a.$)("#form"),this.FORM_TYPE=(0,a.$)("input[name=type]"),this.FORM_RADIO=(0,a.$)(".radio"),this.FORM_DIRECTORY=(0,a.$)("#directory"),this.FORM_NAME=(0,a.$)("#name"),this.FORM_MENU=(0,a.$)("#tree_menu"),this.treeCacheName="treeList",this.treeListAction=new f.TreeListAction,this.formAction=new u.FormAction,this.menuAction=new l.MenuAction,this.treeList=this.treeListAction.getCache(this.treeCacheName)}return i(e,[{key:"init",value:function(){this._formInit(),this._publish(),this.menuInit()}},{key:"_formInit",value:function(){var e=this;this.formAction.selectInit(this.treeList,this.FORM_DIRECTORY[0]),s.validator.config=[{verifyName:"name",verifyItems:[{type:"isEmpty",message:c.message.error.emptyName}]}],(0,a.addEvent)(this.FORM,"submit",function(t){var r=e.FORM_NAME[0].value,n=(0,a.getRadioSelect)(e.FORM_TYPE),i=e.FORM_DIRECTORY[0].value;e.treeList;t.preventDefault(),s.validator.config[0].verifyItems[0].args={value:r},s.validator.validate();var u=s.validator.result;if(e.formAction.printResult(u),s.validator.status){var l={name:r,type:n,id:(0,a.getTime)(),directory:i};e.treeListAction.setCache(e.treeCacheName,l,function(){alert(c.message.success.addSuccess),e.treeList=e.treeListAction.getCache(e.treeCacheName),o.publishAndSubscribe.trigger(e.treeCacheName,e.treeList)})}}),(0,a.addEvent)(this.FORM_TYPE,"click",function(t){var r=t.target,n=void 0;n=r.parentNode,(0,a.isClassName)(n,"on")||((0,a.removeClass)(e.FORM_RADIO,"on"),(0,a.addClass)(n,"on"))})}},{key:"menuInit",value:function(){var e=this;this.menuAction.menuRender(this.treeList,function(t){return e.FORM_MENU[0].innerHTML=t}),(0,a.addEvent)(this.FORM_MENU[0],"click",function(t){var r=t.target.parentNode;r&&"LI"==r.nodeName&&e.treeListAction.delMenu(e.treeCacheName,e.treeList,r.dataset.id,function(t){alert(c.message.success.delSuccess),e.treeList=t,o.publishAndSubscribe.trigger(e.treeCacheName,e.treeList)})})}},{key:"_publish",value:function(){var e=this;o.publishAndSubscribe.listen(this.treeCacheName,function(t,r){e.formAction.selectInit(r,e.FORM_DIRECTORY[0]),e.menuAction.menuRender(r,function(t){return e.FORM_MENU[0].innerHTML=t})})}}]),e}()},function(e,t){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function n(e){return e||o("common.$","elem is undefined"),document.querySelectorAll(e)}function i(e,t){if(e||t||o("common.addEvent","elem or className is undefined"),![].concat(r(e)).length)return void(e.className+=" "+t);for(var n,i=0;n=e[i++];)n.className+=" "+t}function a(e,t){if(e||t||o("common.removeClass","elem or className is undefined"),[].concat(r(e)).length)for(var n,i=0;n=e[i++];){for(var a,s=n.className.split(" "),c=0;a=s[c++];)if(a==t){s.splice(c-1,1);break}n.className=s.join(" ")}else for(var u,l=e.className.split(" "),f=0;u=l[f++];)if(u==t){l.splice(f-1,1),e.className=l.join(" ");break}}function s(e,t){return e||t||o("common.isClassName","elem or className is undefined"),e.className.split(" ").indexOf(t)!==-1}function o(e,t){throw new Error("出错位置："+e+" \n出错信息："+t)}function c(e,t,n){if(e||t||o("common.addEvent","elem or event is undefined"),![].concat(r(e)).length)return void e.addEventListener(t,n,!1);for(var i,a=0;i=e[a++];)i.addEventListener(t,n,!1)}function u(e,t){localStorage.setItem(e,t)}function l(e){return localStorage.getItem(e)}function f(e){e=[].concat(r(e)),e instanceof Array||o("common.getRadioSelect","radios not Array");for(var t,n=0;t=e[n++];)if(t.checked)return t.value;return!1}function v(e){return e=e||new Date,e.getTime()}Object.defineProperty(t,"__esModule",{value:!0}),t.$=n,t.addClass=i,t.removeClass=a,t.isClassName=s,t.throwError=o,t.addEvent=c,t.setCache=u,t.getCache=l,t.getRadioSelect=f,t.getTime=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validator=void 0;var n=r(2);t.validator={types:{isEmpty:function(e,t){var r=!0,n="";return""===e.value&&(r=!1,n=t),{state:r,errorMsg:n}}},result:[],config:{},status:!0,validate:function(){var e=void 0,t=void 0,r=void 0,i=void 0,a=this.config;this.result=[],this.status=!0;for(e in a)if(a.hasOwnProperty(e)){var s={};s.verifyName=a[e].verifyName,s.verifyItems=[],r=a[e].verifyItems;for(var o,c=0;o=r[c++];){var u=void 0;t=o.type,t&&(i=this.types[t],i||(0,n.throwError)("validator.validate.checker","checker is undefined"),u=i(o.args,o.message),u.state||(this.status=!1),Array.prototype.push.call(s.verifyItems,u))}this.result.push(s)}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.publishAndSubscribe={clientList:[],listen:function(e,t){this.clientList[e]||(this.clientList[e]=[]),this.clientList[e].push(t)},trigger:function(e,t){var r=this.clientList[e];if(!r)return!1;for(var n,i=0;n=r[i++];)n.call(this,e,t)},remove:function(e,t){var r=this.clientList[e];if(!r)return!1;if(t)for(var n=r.length-1;n>=0;n--){var i=r[n];i===t&&r.splice(n,1)}else r&&(r.length=0)}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.message={error:{emptyName:"请填写名称!",repeatName:"不能在同一个目录创建同类型的重名文件!"},success:{addSuccess:"添加成功!",delSuccess:"删除成功!"},msg:{delMenuTitle:"点击删除菜单"}}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.FormAction=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2);t.FormAction=function(){function e(){n(this,e)}return i(e,[{key:"printResult",value:function(e){if(e instanceof Array||(0,a.throwError)("FormAction.printResult","result not array"),e.length)for(var t,r=0;t=e[r++];)for(var n,i=t.verifyItems,s=0;n=i[s++];)if(!n.state){alert(n.errorMsg);break}}},{key:"selectInit",value:function(e,t){var r='<option value="top">顶级目录</option>';return e instanceof Array?(r+=this._recursionTree(e),void(t.innerHTML=r)):(t.innerHTML=r,!1)}},{key:"_recursionTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&nbsp;&nbsp;",r="";for(var n in e)if(e.hasOwnProperty(n)&&"folder"==e[n].type){var i=e[n].subMenu;r+='<option value="'+e[n].id+'">'+t+"└"+e[n].name+"</option>",i instanceof Array&&i.length&&i.length&&(r+=this._recursionTree(i,t+="&nbsp;&nbsp;"),t="&nbsp;&nbsp;")}return r}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MenuAction=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(5);t.MenuAction=function(){function e(){n(this,e)}return i(e,[{key:"menuRender",value:function(e,t){if(e instanceof Array){var r=this._recursionTree(e);t(r)}}},{key:"_recursionTree",value:function(e){var t="";for(var r in e)if(e.hasOwnProperty(r)){var n=e[r].subMenu;t+='<li class="'+e[r].type+"\" data-id='"+e[r].id+"'><span title=\""+a.message.msg.delMenuTitle+'">'+e[r].name+"</span>",n instanceof Array&&n.length&&n.length&&(t+=this._recursionTree(n)),t+="</li>"}return"<ul>"+t+"</ul>"}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.TreeListAction=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(2);t.TreeListAction=function(){function e(){n(this,e)}return i(e,[{key:"setCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2],n=void 0;t instanceof Object||(0,a.throwError)("TreeListAction.setCache","data not Object"),n=this.getCache(e)||[],"folder"===t.type&&(t.subMenu=[]),"top"!==t.directory?n=this._recursionTree(n,t,"set"):n.push(t),(0,a.setCache)(e,JSON.stringify(n)),r()}},{key:"getCache",value:function(e){var t=(0,a.getCache)(e);return JSON.parse(t)}},{key:"delMenu",value:function(e,t,r,n){(t instanceof Array||r)&&(t=this._recursionTree(t,r,"del"),(0,a.setCache)(e,JSON.stringify(t)),n(t))}},{key:"_recursionTree",value:function(e,t,r){for(var n in e)if(e.hasOwnProperty(n)){var i=e[n].subMenu;if("del"==r&&t==e[n].id)return e.splice(e.length-1,1),e;if("set"==r&&t.directory==e[n].id)return i.push(t),e;i instanceof Array&&i.length&&i.length&&this._recursionTree(i,t,r)}return e}}]),e}()}]);